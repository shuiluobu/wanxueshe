<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.wxs.mapper.course.TCoursesMapper">

    <!-- 通用查询映射结果 -->
    <resultMap id="BaseResultMap" type="com.wxs.entity.course.TCourse">
        <id column="id" property="id"/>
        <result column="organizationId" property="organizationId"/>
        <result column="courseCode" property="courseCode"/>
        <result column="courseName" property="courseName"/>
        <result column="courseRemark" property="courseRemark"/>
        <result column="marketPrice" property="marketPrice"/>
        <result column="preferenPrice" property="preferenPrice"/>
        <result column="preferStartTime" property="preferStartTime"/>
        <result column="preferEndTime" property="preferEndTime"/>
        <result column="canQty" property="canQty"/>
        <result column="categoryCode" property="categoryCode"/>
        <result column="categoryName" property="categoryName"/>
        <result column="beginTime" property="beginTime"/>
        <result column="endTime" property="endTime"/>
        <result column="createTime" property="createTime"/>
        <result column="status" property="status"/>
    </resultMap>

    <select id="pageData" parameterType="TCourse" resultMap="BaseResultMap">
        select t.*,a.organName,b.courseCategoryName
        from t_course t
        left join t_organization a on a.id = t.organizationId
        left join t_course_category b on b.id = t.courseCateId
        <where>
            1=1
            <if test=" courseCode != null and !''.equals(courseCode)">
                and t.courseCode = #{courseCode}
            </if>
            <if test=" courseName != null and !''.equals(courseName)">
                and t.courseName = #{courseName}
            </if>
            <if test=" beginTime != null and !''.equals(beginTime)">
                and t.beginTime  &gt; #{beginTime}
            </if>
            <if test=" endTime != null and !''.equals(endTime)">
                and t.endTime &lt; #{endTime}
            </if>
            <if test=" canQty != null and !''.equals(canQty)">
                and t.canQty = #{canQty}
            </if>
            <if test=" surplusClassLesson != null and !''.equals(surplusClassLesson)">
                and t.surplusClassLesson = #{surplusClassLesson}
            </if>
            <if test=" courseCateId != null and !''.equals(courseCateId)">
                and t.courseCateId = #{courseCateId}
            </if>
            <if test=" organizationId != null and !''.equals(organizationId)">
                and t.organizationId = #{organizationId}
            </if>
            <if test=" status != null and !''.equals(status)">
                and t.status = #{status}
            </if>
        </where>
        limit #{pageStartIndex},#{limit}
    </select>

    <select id="selectOneCourseById" parameterType="java.lang.Long" resultMap="BaseResultMap">
		SELECT * FROM t_class_courses WHERE id = #{coursesId}
	</select>

    <select id="selectCoursesByIds" parameterType="java.util.List" resultType="java.util.HashMap">
        SELECT
        organizationId,courseCode,courseName,courseRemark,marketPrice,preferenPrice,
        canQty,categoryCode,categoryName
        FROM t_course WHERE id =
        <foreach item="coursesId" collection="cIdList" separator="," open="(" close=")" index="">
            #{coursesId}
        </foreach>
    </select>

    <select id="selectMap" parameterType="java.lang.Long" resultType="java.util.HashMap">
		SELECT s.*,c.className,t.teacherName,o.organName
		FROM t_courses s,t_class c,t_teacher t,t_organization o
        where c.course=s.id
        and c.teacherId=t.id
        and s.organizationId=o.id
        and  s.id = #{coursesId}

	</select>
</mapper>
